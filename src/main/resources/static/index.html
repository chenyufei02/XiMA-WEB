<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>XiMA æ™ºèƒ½å»ºé€ æ§åˆ¶å°</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <style>
        /* --- 1. å…¨å±€æ·±è‰²ä¸»é¢˜å®šä¹‰ --- */
        :root {
            --bg-color: #1e1e2d;
            --sidebar-bg: #151521;
            --card-bg: #2b2b40;
            --text-primary: #e1e1e6;
            --text-secondary: #a2a2b8;
            --accent-purple: #7367f0;
            --accent-blue: #00cfe8;
            --accent-green: #28c76f;
            --accent-red: #ea5455;
            --border-color: rgba(255,255,255,0.08);
            --hover-bg: rgba(255, 255, 255, 0.05);
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
        }

        #app { display: flex; height: 100vh; width: 100vw; }

        /* --- 2. ä¾§è¾¹æ æ ·å¼ --- */
        .sidebar {
            width: 260px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
            flex-shrink: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .logo-area {
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: 700;
            color: white;
            border-bottom: 1px solid var(--border-color);
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(115, 103, 240, 0.3);
        }
        .logo-area i { color: var(--accent-purple); margin-right: 12px; font-size: 26px; }

        .nav-menu { flex: 1; padding: 25px 15px; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 14px 20px;
            margin-bottom: 8px;
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
            font-weight: 500;
        }

        .nav-item:hover {
            background-color: var(--hover-bg);
            color: #fff;
            transform: translateX(5px);
        }

        .nav-item.active {
            background: linear-gradient(90deg, rgba(115, 103, 240, 0.25), transparent);
            color: var(--accent-purple);
            border-left: 4px solid var(--accent-purple);
        }

        .nav-item i { margin-right: 15px; font-size: 20px; width: 24px; text-align: center; }

        /* --- 3. ä¸»å†…å®¹åŒºåŸŸ --- */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            background: radial-gradient(circle at top right, #252535 0%, var(--bg-color) 40%);
        }

        .top-header {
            height: 80px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 40px;
            background-color: rgba(30, 30, 45, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
            z-index: 100;
        }

        .page-title h2 { margin: 0; font-size: 26px; font-weight: 600; letter-spacing: 0.5px; }

        .user-profile { display: flex; align-items: center; gap: 20px; }
        .user-info { text-align: right; line-height: 1.4; }
        .user-name { font-weight: bold; font-size: 14px; color: #fff; }
        .user-role { font-size: 12px; color: var(--text-secondary); }

        .avatar {
            width: 42px; height: 42px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold; color: white;
            font-size: 18px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .logout-btn {
            cursor: pointer; color: var(--accent-red); font-size: 22px;
            transition: transform 0.2s;
            padding: 8px;
            border-radius: 50%;
        }
        .logout-btn:hover { background: rgba(234, 84, 85, 0.1); transform: scale(1.1); }

        .content-scroll {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            scroll-behavior: smooth;
        }

        /* æ»šåŠ¨æ¡ç¾åŒ– */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-color); }
        ::-webkit-scrollbar-thumb { background: #3b3b58; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #505075; }

        /* --- 4. ç»Ÿè®¡å¡ç‰‡åŒº --- */
        .stats-row { display: flex; gap: 25px; margin-bottom: 40px; }
        .stat-card {
            flex: 1;
            background: var(--card-bg);
            padding: 25px 30px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            gap: 25px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .stat-card:hover { transform: translateY(-5px); }

        .stat-icon {
            width: 60px; height: 60px;
            border-radius: 16px;
            display: flex; align-items: center; justify-content: center;
            font-size: 28px;
        }
        .stat-info h3 { margin: 0; font-size: 28px; font-weight: 700; color: #fff; }
        .stat-info p { margin: 5px 0 0 0; font-size: 14px; color: var(--text-secondary); }

        /* --- 5. é¡¹ç›®å¡ç‰‡ Grid å¸ƒå±€ --- */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
            gap: 30px;
        }

        .project-card {
            background-color: var(--card-bg);
            border-radius: 16px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border-color: rgba(115, 103, 240, 0.4);
        }

        .card-stripe { position: absolute; left: 0; top: 0; bottom: 0; width: 6px; }
        .stripe-blue { background: var(--accent-blue); box-shadow: 2px 0 10px rgba(0, 207, 232, 0.4); }
        .stripe-purple { background: var(--accent-purple); box-shadow: 2px 0 10px rgba(115, 103, 240, 0.4); }
        .stripe-green { background: var(--accent-green); box-shadow: 2px 0 10px rgba(40, 199, 111, 0.4); }

        .card-body { padding: 30px; flex: 1; }

        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .p-title { font-size: 22px; font-weight: 700; color: #fff; letter-spacing: 0.5px; }
        .p-status {
            font-size: 12px; padding: 6px 12px; border-radius: 20px;
            background: rgba(40, 199, 111, 0.15); color: var(--accent-green);
            font-weight: 600; text-transform: uppercase;
        }

        .p-info {
            display: flex; flex-direction: column; gap: 10px;
            font-size: 14px; color: var(--text-secondary);
            margin-bottom: 25px;
        }
        .info-item { display: flex; align-items: center; }
        .info-item i { margin-right: 10px; color: var(--accent-purple); width: 16px; }

        /* åŠŸèƒ½æŒ‰é’®åŒº */
        .function-buttons { display: flex; gap: 12px; margin-top: 20px; }

        .btn-neon {
            flex: 1; border: none; padding: 12px 0; border-radius: 8px; cursor: pointer;
            font-size: 13px; font-weight: 600;
            transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 8px;
            color: rgba(255,255,255,0.9);
            position: relative; overflow: hidden;
        }
        .btn-neon::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(255,255,255,0.1), transparent);
            opacity: 0; transition: opacity 0.3s;
        }
        .btn-neon:hover::after { opacity: 1; }

        /* ç´«è‰²ï¼šç”µå­å›´æ  */
        .btn-map { background: rgba(115, 103, 240, 0.15); color: var(--accent-purple); border: 1px solid rgba(115, 103, 240, 0.2); }
        .btn-map:hover { background: var(--accent-purple); color: white; box-shadow: 0 4px 15px rgba(115, 103, 240, 0.4); }

        /* è“è‰²ï¼šæ¥¼å±‚é…ç½® */
        .btn-floor { background: rgba(0, 207, 232, 0.15); color: var(--accent-blue); border: 1px solid rgba(0, 207, 232, 0.2); }
        .btn-floor:hover { background: var(--accent-blue); color: white; box-shadow: 0 4px 15px rgba(0, 207, 232, 0.4); }

        /* ç»¿è‰²ï¼šè®¡åˆ’è¿›åº¦ (æ–°å¢) */
        .btn-plan { background: rgba(40, 199, 111, 0.15); color: var(--accent-green); border: 1px solid rgba(40, 199, 111, 0.2); }
        .btn-plan:hover { background: var(--accent-green); color: white; box-shadow: 0 4px 15px rgba(40, 199, 111, 0.4); }

        /* åº•éƒ¨æ“ä½œåŒº */
        .card-footer {
            background: rgba(0,0,0,0.2);
            padding: 18px 30px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 20px;
        }
        .btn-action {
            background: transparent; border: none; color: var(--text-secondary);
            cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 6px;
            transition: color 0.2s; font-weight: 500;
        }
        .btn-action:hover { color: #fff; }
        .btn-action.delete:hover { color: var(--accent-red); }

        /* Element UI å¼¹çª—æ·±åº¦è¦†ç›– */
        .el-dialog { background-color: #2b2b40 !important; border: 1px solid var(--border-color); border-radius: 12px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .el-dialog__title { color: #fff; font-weight: bold; }
        .el-dialog__header { border-bottom: 1px solid var(--border-color); padding: 20px 25px; }
        .el-dialog__body { color: var(--text-primary); padding: 30px 25px; }
        .el-dialog__footer { border-top: 1px solid var(--border-color); padding: 20px 25px; background: rgba(0,0,0,0.1); }
        .el-form-item__label { color: var(--text-secondary); }
        .el-input__inner, .el-textarea__inner {
            background-color: #151521; border: 1px solid var(--border-color); color: #fff; border-radius: 6px;
        }
        .el-input__inner:focus, .el-textarea__inner:focus { border-color: var(--accent-purple); }
        .el-button--primary { background: linear-gradient(45deg, var(--accent-purple), #9f96f6); border: none; box-shadow: 0 4px 12px rgba(115, 103, 240, 0.3); }
        .el-button--primary:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(115, 103, 240, 0.5); }

        /* ç©ºçŠ¶æ€å›¾æ ‡ */
        .empty-state { text-align: center; margin-top: 80px; color: var(--text-secondary); opacity: 0.6; }
        .empty-state i { font-size: 64px; margin-bottom: 20px; display: block; }
    </style>
</head>
<body>

<div id="app">
    <div class="sidebar">
        <div class="logo-area">
            <i class="el-icon-monitor"></i> XiMA æ™ºé€ 
        </div>
        <div class="nav-menu">
            <div class="nav-item active">
                <i class="el-icon-menu"></i> é¡¹ç›®æ¦‚è§ˆ
            </div>
            <div class="nav-item" @click="goToPage('plan-config.html')">
                <i class="el-icon-date"></i> è®¡åˆ’è¿›åº¦
            </div>
            <div class="nav-item" @click="goToPage('import.html')">
                <i class="el-icon-upload"></i> é¡¹ç›®å¯¼å…¥
            </div>
            <div class="nav-item" @click="goToPage('settings.html')">
                <i class="el-icon-setting"></i> ç³»ç»Ÿè®¾ç½®
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="top-header">
            <div class="page-title">
                <h2>é¡¹ç›®æ§åˆ¶å°</h2>
            </div>
            <div class="user-profile">
                <el-button type="primary" size="small" icon="el-icon-plus" round @click="goToPage('import.html')">æ–°å»ºé¡¹ç›®</el-button>
                <div class="user-info">
                    <div class="user-name">{{ username }}</div>
                    <div class="user-role">ç®¡ç†å‘˜</div>
                </div>
                <div class="avatar">{{ username.substring(0,1).toUpperCase() }}</div>
                <i class="el-icon-switch-button logout-btn" @click="logout" title="é€€å‡ºç™»å½•"></i>
            </div>
        </div>

        <div class="content-scroll">
            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(115, 103, 240, 0.2); color: var(--accent-purple);"><i class="el-icon-folder-opened"></i></div>
                    <div class="stat-info"><h3>{{ projects.length }}</h3><p>è¿›è¡Œä¸­é¡¹ç›®</p></div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(0, 207, 232, 0.2); color: var(--accent-blue);"><i class="el-icon-data-line"></i></div>
                    <div class="stat-info"><h3>Online</h3><p>ç³»ç»ŸçŠ¶æ€æ­£å¸¸</p></div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(40, 199, 111, 0.2); color: var(--accent-green);"><i class="el-icon-cpu"></i></div>
                    <div class="stat-info"><h3>Running</h3><p>è®¡ç®—æœåŠ¡è¿è¡Œä¸­</p></div>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <h3 style="margin: 0; color: var(--text-primary); font-size: 20px;">
                    æˆ‘çš„é¡¹ç›®åˆ—è¡¨
                    <span style="font-size: 14px; color: var(--text-secondary); font-weight: normal; margin-left: 10px;">(å…± {{ projects.length }} ä¸ª)</span>
                </h3>
                <el-input placeholder="æœç´¢é¡¹ç›®..." prefix-icon="el-icon-search" size="small" style="width: 200px;"></el-input>
            </div>

            <div v-if="loading" style="text-align: center; padding: 100px;">
                <i class="el-icon-loading" style="font-size: 40px; color: var(--accent-purple);"></i>
                <p style="color: var(--text-secondary); margin-top: 20px;">åŠ è½½æ˜Ÿé™…æ•°æ®ä¸­...</p>
            </div>

            <div class="dashboard-grid" v-else>
                <div class="project-card" v-for="(item, index) in projects" :key="item.id" @click="goToDashboard(item.id)">
                    <div :class="['card-stripe', getStripeColor(index)]"></div>

                    <div class="card-body">
                        <div class="card-header">
                            <div class="p-title">{{ item.projectName }}</div>
                            <span class="p-status">è¿›è¡Œä¸­</span>
                        </div>

                        <div class="p-info">
                            <div class="info-item"><i class="el-icon-date"></i> åˆ›å»ºæ—¥æœŸï¼š{{ formatDate(item.createdAt) }}</div>
                            <div class="info-item"><i class="el-icon-folder"></i> æºæ–‡ä»¶å¤¹ï¼š{{ item.photoFolderKeyword }}</div>
                        </div>

                        <div class="function-buttons">
                            <button class="btn-neon btn-map" @click.stop="enterFunction('boundary', item.id)">
                                <i class="el-icon-map-location"></i> ç”µå­å›´æ 
                            </button>
                            <button class="btn-neon btn-floor" @click.stop="enterFunction('floor', item.id)">
                                <i class="el-icon-office-building"></i> æ¥¼å±‚é…ç½®
                            </button>
                            <button class="btn-neon btn-plan" @click.stop="enterFunction('plan', item.id)">
                                <i class="el-icon-date"></i> è®¡åˆ’è¿›åº¦
                            </button>
                        </div>
                    </div>

                    <div class="card-footer">
                        <button class="btn-action" @click.stop="openEditModal(item)">
                            <i class="el-icon-setting"></i> é¡¹ç›®è®¾ç½®
                        </button>

                        <el-popconfirm
                            title="ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¡¹ç›®åŠå…¶æ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼"
                            confirm-button-text='ç¡®å®šåˆ é™¤'
                            cancel-button-text='å–æ¶ˆ'
                            icon="el-icon-info"
                            icon-color="red"
                            @confirm="deleteProject(item.id)"
                        >
                            <button class="btn-action delete" slot="reference" @click.stop>
                                <i class="el-icon-delete"></i> åˆ é™¤é¡¹ç›®
                            </button>
                        </el-popconfirm>
                    </div>
                </div>
            </div>

            <div v-if="!loading && projects.length === 0" class="empty-state">
                <i class="el-icon-folder-opened"></i>
                <p>æš‚æ— é¡¹ç›®ï¼Œè¯·ç‚¹å‡»å³ä¸Šè§’ã€Œæ–°å»ºé¡¹ç›®ã€å¯¼å…¥æ•°æ®</p>
            </div>
        </div>
    </div>

    <el-dialog title="é¡¹ç›®è®¾ç½®" :visible.sync="editDialogVisible" width="500px">
        <el-form :model="editForm" label-width="100px">
            <el-form-item label="é¡¹ç›®åç§°">
                <el-input v-model="editForm.projectName"></el-input>
            </el-form-item>
            <el-form-item label="ç…§ç‰‡å…³é”®è¯">
                <el-input v-model="editForm.photoFolderKeyword"></el-input>
            </el-form-item>
            <el-form-item label="é¡¹ç›®è´Ÿè´£äºº">
                <el-input v-model="editForm.manager" placeholder="ï¼ˆç¤ºä¾‹å­—æ®µï¼‰"></el-input>
            </el-form-item>
            <el-form-item label="å¤‡æ³¨ä¿¡æ¯">
                <el-input type="textarea" v-model="editForm.remarks" placeholder="ï¼ˆç¤ºä¾‹å­—æ®µï¼‰"></el-input>
            </el-form-item>
            <el-divider content-position="left">ğŸ“· è¤çŸ³äº‘è§†é¢‘é…ç½®</el-divider>

            <el-form-item label="AppKey">
                <el-input v-model="editForm.ezvizAppKey" placeholder="è¤çŸ³äº‘å¼€å‘è€… AppKey"></el-input>
            </el-form-item>

            <el-form-item label="AppSecret">
                <el-input v-model="editForm.ezvizAppSecret" type="password" show-password placeholder="è¤çŸ³äº‘å¼€å‘è€… Secret"></el-input>
            </el-form-item>

            <el-form-item label="è®¾å¤‡åºåˆ—å·">
                <el-input v-model="editForm.ezvizDeviceSerial" placeholder="ä¾‹å¦‚ï¼šGG9175016"></el-input>
            </el-form-item>

            <el-form-item label="éªŒè¯ç ">
                <el-input v-model="editForm.ezvizValidateCode" placeholder="æœªåŠ å¯†è®¾å¤‡è¯·ç•™ç©ºï¼åŠ å¯†è®¾å¤‡è¯·å¡«6ä½å¤§å†™å­—æ¯"></el-input>
                <div style="font-size: 12px; color: #e6a23c; line-height: 1.2; margin-top: 5px;">
                    <i class="el-icon-warning"></i> æ³¨æ„ï¼šå¦‚æœè®¾å¤‡æœªå¼€å¯è§†é¢‘åŠ å¯†ï¼Œ<b>æ­¤å¤„å¿…é¡»ç•™ç©º</b>ï¼Œå¦åˆ™ä¼šå¯¼è‡´é»‘å±ï¼
                </div>
            </el-form-item>


        </el-form>
        <span slot="footer" class="dialog-footer">
            <el-button @click="editDialogVisible = false" size="small">å– æ¶ˆ</el-button>
            <el-button type="primary" @click="submitEdit" size="small" :loading="saving">ä¿å­˜ä¿®æ”¹</el-button>
        </span>
    </el-dialog>

</div>

<script src="https://unpkg.com/vue@2/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<script>
    new Vue({
        el: '#app',
        data: {
            username: '',
            loading: true,
            saving: false,
            projects: [],
            editDialogVisible: false,
            editForm: { id: null, projectName: '', photoFolderKeyword: '', manager: '', remarks: '' }
        },
        created() {
            this.checkLogin();
            this.fetchProjects();
        },
        methods: {
            getStripeColor(index) {
                const colors = ['stripe-purple', 'stripe-blue', 'stripe-green'];
                return colors[index % 3];
            },

            checkLogin() {
                const token = localStorage.getItem('token');
                const user = localStorage.getItem('username');
                if (!token) { window.location.href = 'login.html'; return; }
                this.username = user || 'Admin';
            },

            fetchProjects() {
                const token = localStorage.getItem('token');
                axios.get('/api/projects/my', {
                    headers: { 'Authorization': 'Bearer ' + token }
                }).then(res => {
                    if (res.data.status === 200 || res.data.code === 200) {
                        this.projects = res.data.data;
                    }
                }).finally(() => {
                    this.loading = false;
                });
            },

            goToDashboard(projectId) {
                localStorage.setItem('currentProjectId', projectId);
                window.location.href = 'dashboard.html';
            },

            goToPage(url) {
                // å¦‚æœæ˜¯å»è®¡åˆ’è¿›åº¦ï¼Œæ¸…é™¤ dashboard æ¥æºæ ‡è®°ï¼Œç¡®ä¿æ˜¾ç¤ºå…¨å±€ä¾§è¾¹æ 
                if(url === 'plan-config.html') localStorage.removeItem('fromDashboard');
                window.location.href = url;
            },

            enterFunction(type, projectId) {
                localStorage.setItem('currentProjectId', projectId);
                // ä»é¦–é¡µå¡ç‰‡è¿›å…¥åŠŸèƒ½é¡µï¼Œè§†ä¸ºâ€œå…¨å±€å…¥å£â€ï¼Œæ¸…é™¤ fromDashboard æ ‡è®°
                localStorage.removeItem('fromDashboard');

                if (type === 'boundary') window.location.href = 'boundary.html';
                else if (type === 'floor') window.location.href = 'floor-config.html';
                else if (type === 'plan') window.location.href = 'plan-config.html';
            },

            logout() {
                localStorage.removeItem('token');
                window.location.href = 'login.html';
            },

            formatDate(str) {
                return str ? str.split('T')[0] : 'æœªçŸ¥æ—¥æœŸ';
            },

            deleteProject(id) {
                const token = localStorage.getItem('token');
                axios.delete('/api/projects/' + id, {
                    headers: { 'Authorization': 'Bearer ' + token }
                }).then(res => {
                    if (res.data.status === 200 || res.data.code === 200) {
                        this.$message.success('åˆ é™¤æˆåŠŸ');
                        this.fetchProjects();
                    } else {
                        this.$message.error('åˆ é™¤å¤±è´¥: ' + res.data.message);
                    }
                }).catch(() => {
                    this.$message.error('ç½‘ç»œé”™è¯¯');
                });
            },

            openEditModal(item) {
                this.editForm = {
                    id: item.id,
                    projectName: item.projectName,
                    photoFolderKeyword: item.photoFolderKeyword,
                    manager: '',
                    remarks: '',
                    // ğŸ”¥ æ–°å¢ï¼šå›æ˜¾è¤çŸ³äº‘é…ç½®
                    ezvizAppKey: item.ezvizAppKey || '',
                    ezvizAppSecret: item.ezvizAppSecret || '',
                    ezvizDeviceSerial: item.ezvizDeviceSerial || '',
                    ezvizValidateCode: item.ezvizValidateCode || ''
                };
                this.editDialogVisible = true;
            },

            submitEdit() {
                this.saving = true;
                const token = localStorage.getItem('token');
                axios.put('/api/projects/' + this.editForm.id, this.editForm, {
                    headers: { 'Authorization': 'Bearer ' + token }
                }).then(res => {
                    if (res.data.status === 200 || res.data.code === 200) {
                        this.$message.success('æ›´æ–°æˆåŠŸ');
                        this.editDialogVisible = false;
                        this.fetchProjects();
                    } else {
                        this.$message.error('æ›´æ–°å¤±è´¥');
                    }
                }).finally(() => {
                    this.saving = false;
                });
            }
        }
    })
</script>
</body>
</html>